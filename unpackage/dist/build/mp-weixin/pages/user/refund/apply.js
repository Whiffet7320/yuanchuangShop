(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/refund/apply"],{"0306":function(e,t,n){"use strict";n.r(t);var o=n("2906"),r=n("8852");for(var a in r)"default"!==a&&function(e){n.d(t,e,(function(){return r[e]}))}(a);n("f366");var s,u=n("f0c5"),i=Object(u["a"])(r["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],s);t["default"]=i.exports},"1f11":function(e,t,n){},2906:function(e,t,n){"use strict";var o;n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o}));var r=function(){var e=this,t=e.$createElement,n=(e._self._c,e.$wanlshop.oss(e.goods.image,70,70)),o=e.__map(e.refund.images,(function(t,n){var o=e.__get_orig(t),r=e.$wanlshop.oss(t,90,90);return{$orig:o,g1:r}}));e.$mp.data=Object.assign({},{$root:{g0:n,l0:o}})},a=[]},6355:function(e,t,n){"use strict";(function(e){n("0429");o(n("66fd"));var t=o(n("0306"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},8852:function(e,t,n){"use strict";n.r(t);var o=n("c1e2"),r=n.n(o);for(var a in o)"default"!==a&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t["default"]=r.a},c1e2:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("a34a"));function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,o,r,a,s){try{var u=e[a](s),i=u.value}catch(c){return void n(c)}u.done?t(i):Promise.resolve(i).then(o,r)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var s=e.apply(t,n);function u(e){a(s,o,r,u,i,"next",e)}function i(e){a(s,o,r,u,i,"throw",e)}u(void 0)}))}}var u={data:function(){return{freight_type:0,goods:{},expressList:["未收到货","已收到货"],typeList:["我要退款(无需退货)","退货退款"],reasonList:["不喜欢","空包裹","一直未送达","颜色/尺码不符","质量问题","少件漏发","假冒品牌"],refund:{order_id:0,expressType:-1,type:-1,reason:-1,goods:0,money:0,images:[],refund_content:""},amount:{total:0,placeholder:"",info:""}}},onLoad:function(e){var t=JSON.parse(e.data);if(console.log(t),this.goods=t.goods,this.refund.order_id=t.order_id,this.refund.goods=t.goods.id,this.freight_type=t.freight_type,this.goods_number=t.goods_number,1==this.goods_number||2==this.freight_type){var n=this.$wanlshop.bcadd(t.goods.actual_payment,t.goods.freight_price),o="最多￥".concat(n);parseInt(t.discount_price)>0&&(o+="，其中总额￥".concat(this.$wanlshop.bcmul(t.goods.price,t.goods.number),"，优惠￥").concat(t.goods.discount_price)),parseInt(t.goods.freight_price)>0&&(o+="，包含运费￥".concat(t.goods.freight_price)),this.amount.info=o,this.amount.placeholder="退款金额不能超过 ￥".concat(n," 元"),this.amount.total=Number(n)}else{var r=t.goods.actual_payment,a="注意：最多￥".concat(r);parseInt(t.goods.discount_price)>0&&(a+="，其中总额￥".concat(this.$wanlshop.bcmul(t.goods.price,t.goods.number),"，优惠￥").concat(t.goods.discount_price)),parseInt(t.goods.freight_price)>0&&(a+="，策略不包含运费￥".concat(t.goods.freight_price)),this.amount.info=a,this.amount.placeholder="退款金额不能超过 ￥".concat(r," 元"),this.amount.total=Number(r)}},methods:{addData:function(){var t=this;return s(o.default.mark((function n(){return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!(t.refund.money>t.amount.total)){n.next=3;break}return t.$wanlshop.msg(t.amount.info),n.abrupt("return",!1);case 3:if(-1!=t.refund.expressType){n.next=6;break}return t.$wanlshop.msg("请选择物流状态"),n.abrupt("return",!1);case 6:if(-1!=t.refund.type){n.next=9;break}return t.$wanlshop.msg("请选择退款类型"),n.abrupt("return",!1);case 9:if(-1!=t.refund.reason){n.next=12;break}return t.$wanlshop.msg("请选择退款原因"),n.abrupt("return",!1);case 12:t.refund.money<=0&&e.showModal({title:"重要提示",content:"你的退款金额可能是零元，可能失去售后机会是否确认",success:function(e){if(e.cancel)return!1}}),t.$api.post({url:"/wanlshop/refund/addApply",data:t.refund,success:function(e){t.$store.commit("statistics/order",{customer:t.$store.state.statistics.order.customer+1}),t.$wanlshop.to("/pages/user/refund/details?id=".concat(e))}});case 14:case"end":return n.stop()}}),n)})))()},chooseImage:function(t){var n=this;e.chooseImage({count:4,sizeType:["original","compressed"],sourceType:["album"],success:function(t){n.$api.get({url:"/wanlshop/common/uploadData",success:function(o){for(var r=0;r<t.tempFilePaths.length;r++)e.getImageInfo({src:t.tempFilePaths[r],success:function(e){n.$api.upload({url:o.uploadurl,filePath:e.path,name:"file",formData:"local"==o.storage?null:o.multipart,success:function(e){n.refund.images.push(e.fullurl)}})}})}})}})},expressChange:function(e){this.refund.expressType=e.detail.value},typeChange:function(e){this.refund.type=e.detail.value},reasonChange:function(e){this.refund.reason=e.detail.value},moneyInput:function(e){var t=e.detail.value;t>this.amount.total&&this.$wanlshop.msg(this.amount.info),this.refund.money=e.detail.value},viewImage:function(t){e.previewImage({urls:this.refund.images,current:this.refund.images[t]})},delImg:function(e){this.refund.images.splice(e,1)}}};t.default=u}).call(this,n("543d")["default"])},f366:function(e,t,n){"use strict";var o=n("1f11"),r=n.n(o);r.a}},[["6355","common/runtime","common/vendor"]]]);