(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/auth/auth"],{"2bf7":function(e,n,t){"use strict";var o;t.d(n,"b",(function(){return a})),t.d(n,"c",(function(){return c})),t.d(n,"a",(function(){return o}));var a=function(){var e=this,n=e.$createElement;e._self._c},c=[]},8340:function(e,n,t){"use strict";(function(e){t("0429");o(t("66fd"));var n=o(t("977b"));function o(e){return e&&e.__esModule?e:{default:e}}e(n.default)}).call(this,t("543d")["createPage"])},"903f":function(e,n,t){},"977b":function(e,n,t){"use strict";t.r(n);var o=t("2bf7"),a=t("d6bc");for(var c in a)"default"!==c&&function(e){t.d(n,e,(function(){return a[e]}))}(c);t("e7dc");var i,r=t("f0c5"),u=Object(r["a"])(a["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],i);n["default"]=u.exports},a5b8:function(e,n,t){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=a(t("f58c"));function a(e){return e&&e.__esModule?e:{default:e}}var c={data:function(){return{submitDisabled:!0,providerList:[],loginRes:{},pageroute:""}},onLoad:function(n){var t=this,o=this.$wanlshop.prePage().$mp.page;this.pageroute=encodeURIComponent("/".concat(o.route,"?").concat(this.queryParams(o.options))),e.getProvider({service:"oauth",success:function(e){t.providerList=e.provider.map((function(e){var n="",t="";switch(e){case"weixin":n="wlIcon-WeChat",t="mp_weixin";break;case"qq":n="wlIcon-QQ",t="mp_qq";break;case"sinaweibo":n="wlIcon-WeiBo",t="app_weibo";break;case"xiaomi":n="wlIcon-Xiaomi",t="app_xiaomi";break;case"apple":n="wlIcon-Apple",t="apple";break}return{id:e,name:n,platform:t}}))},fail:function(e){console.log("获取登录通道失败",e)}}),e.login({provider:"weixin",success:function(e){t.loginRes=e},fail:function(e){t.$wanlshop.msg(e.msg)}})},methods:{tologin:function(n){var t=this;e.showLoading({title:"登录中"}),e.login({provider:n.id,success:function(o){t.$api.post({url:"/wanlshop/user/third",data:{platform:n.platform,loginData:o,client_id:e.getStorageSync("wanlshop:chat_client_id")?e.getStorageSync("wanlshop:chat_client_id"):null},success:function(o){e.hideLoading(),0==o.binding?t.$wanlshop.to("/pages/user/auth/perfect?third_id=".concat(o.third_id,"&platform=").concat(n.platform,"&url=").concat(t.pageroute)):(t.$store.dispatch("user/login",o),t.$store.dispatch("cart/login"),t.$store.dispatch("chat/get"),e.reLaunch({url:decodeURIComponent(t.pageroute)}))}}),e.hideKeyboard()},fail:function(e){t.$wanlshop.msg(e.msg)}})},onKeyInput:function(e){this.submitDisabled=!1},decryptPhoneNumber:function(n){var t=this;"getPhoneNumber:fail user deny"!=n.detail.errMsg&&e.login({success:function(o){t.$api.post({url:"/wanlshop/user/phone",data:{encryptedData:n.detail.encryptedData,iv:n.detail.iv,code:o.code,client_id:e.getStorageSync("wanlshop:chat_client_id")?e.getStorageSync("wanlshop:chat_client_id"):null},success:function(n){t.$store.dispatch("user/login",n),t.$store.dispatch("cart/login"),e.reLaunch({url:decodeURIComponent(t.pageroute)})}})}})},formSubmit:function(n){var t=this,a=[{name:"account",checkType:"phoneno",errorMsg:"不是手机号码"}],c=n.detail.value,i=o.default.check(c,a);i?this.$api.get({url:"/wanlshop/validate/check_mobile_exist",data:{mobile:c.account},success:function(e){t.$wanlshop.to("phone?mobile=".concat(c.account,"&url=").concat(t.pageroute),"none")},fail:function(n){e.showModal({title:"提示",content:"账号不存在，是否注册？",success:function(e){e.confirm?t.$wanlshop.to("register?mobile=".concat(c.account,"&url=").concat(t.pageroute)):e.cancel&&console.log("取消")}})}}):c.account?this.$wanlshop.to("name?name=".concat(c.account,"&url=").concat(this.pageroute),"none"):this.$wanlshop.msg("请填写账号")},register:function(){this.$wanlshop.to("register?url=".concat(this.pageroute))},help:function(){this.$wanlshop.to("/pages/user/help?url=".concat(this.pageroute))},queryParams:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=n?"?":"",o=[],a=function(n){var t=e[n];if(["",void 0,null].includes(t))return"continue";t.constructor===Array?t.forEach((function(e){o.push(encodeURIComponent(n)+"[]="+encodeURIComponent(e))})):o.push(encodeURIComponent(n)+"="+encodeURIComponent(t))};for(var c in e)a(c);return o.length?t+o.join("&"):""}}};n.default=c}).call(this,t("543d")["default"])},d6bc:function(e,n,t){"use strict";t.r(n);var o=t("a5b8"),a=t.n(o);for(var c in o)"default"!==c&&function(e){t.d(n,e,(function(){return o[e]}))}(c);n["default"]=a.a},e7dc:function(e,n,t){"use strict";var o=t("903f"),a=t.n(o);a.a}},[["8340","common/runtime","common/vendor"]]]);